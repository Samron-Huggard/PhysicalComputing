<html> 
    <head> 
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, maximum-scale=1.0" />

        <title>Sam's HCDE 439 Physical Computing Page!</title> 

        <link href="style.css" media="screen" rel="stylesheet" type="text/css" />

    </head> 
    <body> 

        <div class="header">
            <h1>Sam's Assignment 3!</h1>
            <p>
            <img src="A3/A3.gif" width=400></a>
            </p>
            <p>
            For assignment 3, I controled a servo motor with a photoresistor! First, you calibrate the sensor by making it very dark then very light. The servo will move slowly in bright light and <br>
            speed up as it gets darker. Imagined using this to keep and underwater sea gadget at an appropriate depth, since it would engage the motor as it sinks.
            </p>
            <h3>Code</h3>
            <pre>
                <code>
#include <Servo.h> // adding servo library
Servo servo; // assigning name to servo

const int analogInPin = A0;  // Analog input pin that the potentiometer is attached to
const int analogOutPin = 9; // Analog output pin that the LED is attached to

int sensorValue = 0;        // value read from the pot
int outputValue = 0;        // value output to the PWM (analog out)
int sensorMin = 1023;       // sets the sensor minimun to highest value before calibrating
int sensorMax = 0;          // sets the sensor maximun to lowest value before calibrating
int posChange = 0;          // defines the position change for each loop pass

void setup() {
  // put your setup code here, to run once:
Serial.begin(9600);         // sets bps rate
servo.attach(9);            // connect servo to pin 9
servo.write(0);             // move servo to position 0


  while(millis()< 5000){    // calibration loop, runs for 5 seconds
    
    if(analogRead(analogInPin) < sensorMin){  // opens when sensor reads below current minimum reading
      sensorMin = analogRead(analogInPin);    // sets new minimun to current value
    }

    if(analogRead(analogInPin) > sensorMax){  // opens when sensor reads above current maximun reading
      sensorMax = analogRead(analogInPin);    // set new maximun to current value
    }
  }

}

void loop() {

  for(int i = 0; i < 181; i += posChange){ // loop moves servo from 0 to 180
    sensorValue = constrain(analogRead(analogInPin), sensorMin, sensorMax); // reads the photoresistor, constrained to calibrated min/max
    posChange = constrain(map(sensorValue, sensorMin, sensorMax, 25, 1), 1, 25); // sets the index change based on sensor value, constrained 1-25
    servo.write(i); // moves motor position to index value
    delay(15); // short pause
  }

  for(int i = 180; i > -1; i -= posChange){ // loop moves servo 180 to 0
    sensorValue = constrain(analogRead(analogInPin), sensorMin, sensorMax); // reads the photoresistor, constrained to calibrated min/max
    posChange = constrain(map(sensorValue, sensorMin, sensorMax, 25, 1),1,25); // sets the index change based on sensor value, constrained 1-25
    servo.write(i); // moves motor position to index value
    delay(15); //short pause
  }

  
}
                </code>
            </pre>
            </p>

            <h3>Schematic</h3>
            <p>
            <img src="A3/A3_schematic.jpg" width=800></a> <br>
            </p>
            <h3>Breadboard</h3>
            <p>
            <img src="A3/A3_circuit.jpg" width=800></a>
            </p>
            <h3>Questions</h3>
            <p>
                
                1: Draw a chart where the X axis is time and the Y axis is voltage. Draw 3 lines representing the voltage across an LED with analogWrite(led, 64), analogWrite(led, 128), and analogWrite(led,255). <br>
                
            <br>
                2: Given your schematic, circuit, and firmware, assuming the only thing that draws current is your LEDs, how long would your circuit run if powered by a 1200 mAh battery? <br>
                    Since only one LED runs at a time the current would be 3.2V/220ohms= 14.5mA. Because of the consistent fade an LED would only be on half the time, avergaing to 7.25 mA.
                    1200mAh/7.25mA = 165.5 hours.

            </p>

        </div>
        
    </body>
</html>
